import{_ as s}from"./vendor.21c2b6f5.js";import{I as l}from"./InlineCheckboxGroup.9e810507.js";import{I as d}from"./InputGroup.d82ecd1f.js";import{C as r}from"./ConfirmationModal.caf623a6.js";import{G as m}from"./GenericModal.4b26f2ac.js";import{n as u}from"./LogoLight.eaabebeb.js";import"./checkbox-form-group.50e62bcf.js";const c={name:"AdminTenantEdit",components:{GenericModal:m,ConfirmationModal:r,InlineCheckboxGroup:l,InputGroup:d},layout:"admin-layout",props:{modules:{required:!0,type:Object},tenant:{required:!0,type:Object}},data(){return{domainData:null,domainIndexToDelete:null,enabledModules:{},formData:null,isLoadingDomain:!1,showAddDomainModal:!1,showDeleteDomainModal:!1}},computed:{deleteDomainModalText(){try{return"Do you really want to delete '"+this.domainToDelete.domain+"'?"}catch{return"Do you really want to delete this domain?"}},domainToDelete(){try{return this.tenant.domains[this.domainIndexToDelete]}catch{return null}},enabledModulesFormatted(){let a=[];return s.forEach(this.enabledModules,(t,e)=>{t&&a.push(e)}),a}},created(){this.formData={id:this.tenant.id,modules:[]},s.forEach(this.modules,(a,t)=>{let e=this.tenant.modules&&this.tenant.modules.indexOf(t)>=0;this.$set(this.enabledModules,t,e)})},methods:{addDomain(){this.domainData={domain:""},this.showAddDomainModal=!0},cancelDomainDelete(){this.isLoadingDomain||(this.showDeleteDomainModal=!1,this.domainIndexToDelete=null)},checkDomainDelete(a){this.domainIndexToDelete=a,this.showDeleteDomainModal=!0},closeAddDomainModal(){this.isLoadingDomain||(this.showAddDomainModal=!1)},confirmDomainDelete(){if(this.isLoadingDomain)return this.$errorToast("It's only possible to delete one domain at a time.");if(!this.domainToDelete)return this.$errorToast("Unable to identify domain to delete.");axios.delete(this.$route("landlord.admin.api.tenants.domains.destroy",{tenant:this.tenant.id,domain:this.domainToDelete.id})).then(a=>{this.$successToast("Domain successfully deleted."),this.showDeleteDomainModal=!1,this.tenant.domains.splice(this.domainIndexToDelete,1),this.domainIndexToDelete=null}).catch(a=>{console.log(a),this.$errorToast("Failed to delete domain.")}).finally(()=>{this.isLoadingDomain=!1})},submitAddDomain(){this.isLoadingDomain=!0,axios.post(this.$route("landlord.admin.api.tenants.domains.store",this.tenant.id),this.domainData).then(a=>{this.tenant.domains.push(a.data.data),this.showAddDomainModal=!1,this.$successToast("Successfully added domain: "+a.data.data.domain)}).catch(a=>{var e,n;let t="Failed to create domain, please try again";(n=(e=a==null?void 0:a.response)==null?void 0:e.data)!=null&&n.message&&(t=a.response.data.message),this.$errorToast(t)}).finally(()=>{this.isLoadingDomain=!1})},submit(){this.formData.modules=s.clone(this.enabledModulesFormatted),this.$inertia.put(this.$route("landlord.admin.tenants.update",this.tenant.id),this.formData)}}};var p=function(){var t=this,e=t._self._c;return e("form",{staticClass:"max-w-5xl mx-auto",attrs:{autocomplete:"off"},on:{submit:function(n){return n.preventDefault(),t.submit.apply(null,arguments)}}},[t.userCan("tenants.edit")?e("div",{staticClass:"flex flex-row items-center mb-6"},[e("h1",{staticClass:"font-medium mr-auto text-lg"},[t._v(" Edit Tenant "),e("span",{staticClass:"ml-2 opacity-75 text-sm"},[t._v(" "+t._s(t.tenant.id)+" ")])]),t.userCan("tenants.view")?e("inertia-link",{staticClass:"button button-default-responsive button-primary-subtle flex flex-row items-center mr-2",attrs:{href:t.$route("landlord.admin.tenants.index")}},[e("icon-chevron-left",{staticClass:"w-5 md:mr-2"}),e("span",{staticClass:"hidden md:inline"},[t._v(" Back ")])],1):t._e(),e("button",{staticClass:"button button-default-responsive button-primary flex flex-row items-center",attrs:{type:"submit"}},[e("icon-save",{staticClass:"w-5 md:mr-2"}),e("span",{staticClass:"hidden md:inline"},[t._v(" Save Changes ")])],1)],1):t._e(),e("div",{staticClass:"bg-white py-6 shadow-subtle rounded-lg"},[e("div",{staticClass:"block px-6 w-full"},[e("input-group",{attrs:{"error-message":t.getPageErrorMessage("id"),"input-autocomplete":"off","input-autofocus":!0,"input-id":"id","input-name":"id","input-required":!0,"input-type":"text","label-text":"ID"},on:{errorHidden:function(n){return t.clearPageErrorMessage("id")}},model:{value:t.formData.id,callback:function(n){t.$set(t.formData,"id",n)},expression:"formData.id"}}),e("input-group",{staticClass:"mt-4",attrs:{"input-autocomplete":"off","input-disabled":!0,"input-id":"tenancy_db_name","input-name":"tenancy_db_name","input-type":"text","label-text":"DB Name"},model:{value:t.tenant.tenancy_db_name,callback:function(n){t.$set(t.tenant,"tenancy_db_name",n)},expression:"tenant.tenancy_db_name"}})],1)]),e("div",{staticClass:"bg-white mt-6 py-6 shadow-subtle rounded-lg"},[e("div",{staticClass:"block px-6 w-full"},[e("span",{staticClass:"font-medium text-theme-base-contrast tracking-wider"},[t._v(" Modules ")]),e("div",{staticClass:"mt-4 space-y-4"},t._l(t.enabledModules,function(n,o){return e("inline-checkbox-group",{key:`module-${o}`,attrs:{"input-id":`module-${o}`,"input-name":`module-${o}`,"label-text":t.modules[o],"input-value-true":!0,"input-value-false":!1},model:{value:t.enabledModules[o],callback:function(i){t.$set(t.enabledModules,o,i)},expression:"enabledModules[moduleKey]"}})}),1)])]),e("div",{staticClass:"bg-white mt-6 py-6 shadow-subtle rounded-lg"},[e("div",{staticClass:"block px-6 w-full"},[e("div",{staticClass:"flex flex-row items-center mb-4"},[e("span",{staticClass:"font-medium text-theme-base-contrast tracking-wider"},[t._v(" Domains ")]),e("button",{staticClass:"button button-primary-subtle button-small ml-auto text-sm",attrs:{type:"button"},on:{click:t.addDomain}},[t._v(" Add Domain ")])]),t.tenant.domains.length?e("div",{staticClass:"space-y-3"},t._l(t.tenant.domains,function(n,o){return e("div",{key:`domain-${n.domain}`},[e("div",{staticClass:"border-2 border-theme-base-subtle flex flex-row items-center py-1 rounded"},[e("span",{staticClass:"font-semibold ml-4 mr-auto"},[t._v(" "+t._s(n.domain)+" ")]),e("button",{staticClass:"flex flex-row items-center inline-flex mx-1 px-2 py-1 rounded text-theme-base-subtle-contrast text-sm tracking-wide focus:outline-none focus:ring hover:bg-theme-danger hover:text-theme-danger-contrast",attrs:{title:"Delete Menu Item",type:"button"},on:{click:function(i){return t.checkDomainDelete(o)}}},[e("icon-trash",{staticClass:"w-4"})],1)])])}),0):e("p",{staticClass:"bg-theme-base-subtle mt-6 px-4 py-3 rounded text-center text-theme-base-subtle-contrast"},[t._v(" No domains ")])])]),e("generic-modal",{attrs:{"show-modal":t.showAddDomainModal},on:{closeModal:t.closeAddDomainModal}},[t.showAddDomainModal?e("form",{staticClass:"mx-6 mb-6",attrs:{autocomplete:"off"},on:{submit:function(n){return n.preventDefault(),n.stopPropagation(),t.submitAddDomain.apply(null,arguments)}}},[e("input-group",{attrs:{"error-message":t.getPageErrorMessage("domain"),"input-autocomplete":"off","input-autofocus":!0,"input-disabled":t.isLoadingDomain,"input-id":"domain","input-name":"domain","input-required":!0,"input-type":"text","label-text":"Domain"},on:{errorHidden:function(n){return t.clearPageErrorMessage("domain")}},model:{value:t.domainData.domain,callback:function(n){t.$set(t.domainData,"domain",n)},expression:"domainData.domain"}}),e("div",{staticClass:"flex flex-row justify-end"},[e("button",{staticClass:"button button-default-responsive button-primary button-small mt-4 flex flex-row items-center",attrs:{disabled:t.isLoadingDomain,type:"submit"}},[t._v(" Add Domain ")])])],1):t._e()]),e("confirmation-modal",{attrs:{"confirm-text":"Delete","confirm-type":"danger","show-modal":t.showDeleteDomainModal,"message-text":t.deleteDomainModalText},on:{cancelAction:t.cancelDomainDelete,closeModal:t.cancelDomainDelete,confirmAction:t.confirmDomainDelete}})],1)},f=[],h=u(c,p,f,!1,null,null,null,null);const w=h.exports;export{w as default};
